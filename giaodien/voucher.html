<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Voucher CRUD</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Quicksand', Arial, sans-serif;
      background: linear-gradient(135deg, #fffbe6 0%, #ffe5ec 100%);
      padding: 0;
      margin: 0;
      min-height: 100vh;
    }
    h2 {
      color: #ff7043;
      text-align: center;
      margin-top: 32px;
      font-size: 2.2rem;
      letter-spacing: 2px;
      font-family: 'Quicksand', cursive, sans-serif;
      text-shadow: 1px 2px 0 #fff3e0;
    }
    .form-container {
      background: #fff;
      padding: 28px 32px 20px 32px;
      border-radius: 20px;
      box-shadow: 0 4px 24px rgba(255,112,67,0.10);
      max-width: 420px;
      margin: 32px auto 24px auto;
      display: flex;
      flex-direction: column;
      gap: 14px;
      border: 2.5px dashed #ff7043;
      position: relative;
    }
    .form-container:before {
      content: "üéÅ";
      position: absolute;
      top: -30px;
      left: 24px;
      font-size: 2.2rem;
      background: #fffbe6;
      border-radius: 50%;
      padding: 6px;
      border: 2px solid #ff7043;
    }
    .form-container h3 {
      color: #ff7043;
      margin-bottom: 10px;
      font-size: 1.3rem;
      letter-spacing: 1px;
      text-align: left;
    }
    .form-container input {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 8px;
      border: 1.5px solid #ffd6c1;
      border-radius: 8px;
      font-size: 1.05rem;
      background: #fff8f3;
      transition: border 0.2s;
      font-family: 'Quicksand', Arial, sans-serif;
    }
    .form-container input:focus {
      border: 1.5px solid #ff7043;
      outline: none;
    }
    .form-container button {
      padding: 11px 0;
      background: linear-gradient(90deg, #ff7043 60%, #ffa726 100%);
      border: none;
      color: #fff;
      font-weight: bold;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
      letter-spacing: 1px;
      margin-top: 6px;
      box-shadow: 0 2px 8px rgba(255,112,67,0.08);
      transition: background 0.2s, transform 0.1s;
    }
    .form-container button:hover {
      background: linear-gradient(90deg, #ffa726 60%, #ff7043 100%);
      transform: scale(1.04);
    }
    #voucherList {
      display: flex;
      flex-wrap: wrap;
      gap: 28px;
      justify-content: center;
      margin-bottom: 40px;
    }
    .voucher {
      background: #fff;
      border-radius: 18px;
      border: 2.5px dashed #ffa726;
      box-shadow: 0 2px 12px rgba(255,112,67,0.10);
      width: 320px;
      min-height: 160px;
      padding: 22px 20px 18px 20px;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: box-shadow 0.2s, transform 0.2s;
      overflow: hidden;
    }
    .voucher:before {
      content: "üé´";
      position: absolute;
      top: -18px;
      right: 18px;
      font-size: 2.1rem;
      background: #fffbe6;
      border-radius: 50%;
      padding: 4px;
      border: 2px solid #ffa726;
    }
    .voucher .info {
      margin-bottom: 8px;
      font-size: 1.08rem;
      color: #ff7043;
      font-weight: 600;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 7px;
    }
    .voucher .info .tag {
      background: #ffa726;
      color: #fff;
      border-radius: 6px;
      padding: 2px 8px;
      font-size: 0.95em;
      margin-left: 6px;
      font-weight: bold;
      letter-spacing: 1px;
      display: inline-block;
    }
    .voucher .info .expire {
      color: #e53935;
      font-weight: 700;
      font-size: 1em;
      margin-left: 8px;
    }
    .actions {
      display: flex;
      gap: 10px;
      margin-top: 8px;
    }
    .actions button {
      flex: 1;
      padding: 9px 0;
      border: none;
      border-radius: 7px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      font-size: 1rem;
      letter-spacing: 1px;
      transition: background 0.2s, transform 0.1s;
      box-shadow: 0 1px 4px #ffa72633;
    }
    .actions button:nth-child(1) {
      background: #43a047;
    }
    .actions button:nth-child(1):hover {
      background: #388e3c;
      transform: scale(1.04);
    }
    .actions button:nth-child(2) {
      background: #e53935;
    }
    .actions button:nth-child(2):hover {
      background: #b71c1c;
      transform: scale(1.04);
    }
    @media (max-width: 700px) {
      .form-container, .voucher { max-width: 98vw; }
      .voucher { padding: 14px 6px; }
      #voucherList { gap: 12px; }
    }
  </style>
</head>
<body>
  <h2>üéÅ Qu·∫£n l√Ω Voucher ∆Øu ƒê√£i</h2>
  <div class="form-container">
    <h3>Th√™m ho·∫∑c S·ª≠a Voucher</h3>
    <input type="text" id="ma_voucher" placeholder="M√£ voucher">
    <input type="number" id="giam_gia" placeholder="Gi·∫£m gi√° (%)">
    <input type="date" id="thoi_gian_het_han" placeholder="Th·ªùi gian h·∫øt h·∫°n (dd/MM/yyyy)">
    <input type="hidden" id="voucher_id">
    <button onclick="addOrUpdateVoucher()">L∆∞u Voucher</button>
  </div>

  <h2>Danh s√°ch Voucher</h2>
  <div id="voucherList"></div>

  <script>
    const apiURL = "https://68431f28e1347494c31f29ef.mockapi.io/voucher";

    async function fetchVouchers() {
      const res = await fetch(apiURL);
      const data = await res.json();
      const list = document.getElementById("voucherList");
      list.innerHTML = "";

      data.forEach(v => {
        list.innerHTML += `
          <div class="voucher">
            <div class="info"><span>üîñ</span><strong>M√£:</strong> <span class="tag">${v.ma_voucher}</span></div>
            <div class="info"><span>üí∏</span><strong>Gi·∫£m gi√°:</strong> <span class="tag">${v.giam_gia}%</span></div>
            <div class="info"><span>‚è∞</span><strong>H·∫øt h·∫°n:</strong> <span class="expire">${v.thoi_gian_het_han}</span></div>
            <div class="actions">
              <button onclick="editVoucher('${v.voucher_id}', '${v.ma_voucher}', '${v.giam_gia}', '${v.thoi_gian_het_han}')">S·ª≠a</button>
              <button onclick="deleteVoucher('${v.voucher_id}')">X√≥a</button>
            </div>
          </div>
        `;
      });
    }

    async function addOrUpdateVoucher() {
      const ma_voucher = document.getElementById("ma_voucher").value;
      const giam_gia = parseInt(document.getElementById("giam_gia").value);
      const thoi_gian_het_han = document.getElementById("thoi_gian_het_han").value;
      const id = document.getElementById("voucher_id").value;

      if (!ma_voucher || !giam_gia || !thoi_gian_het_han) {
        return alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
      }

      const voucher = {
        ma_voucher,
        giam_gia,
        thoi_gian_het_han,
        khach_hang_id: "" // M·∫∑c ƒë·ªãnh r·ªóng khi th√™m m·ªõi
      };

      if (id === "") {
        // Th√™m m·ªõi
        await fetch(apiURL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(voucher)
        });
      } else {
        // S·ª≠a
        await fetch(`${apiURL}/${id}`, {
          method: "PUT",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(voucher)
        });
      }

      // Reset form
      document.getElementById("ma_voucher").value = "";
      document.getElementById("giam_gia").value = "";
      document.getElementById("thoi_gian_het_han").value = "";
      document.getElementById("voucher_id").value = "";

      fetchVouchers();
    }

    function editVoucher(id, ma_voucher, giam_gia, thoi_gian_het_han) {
      document.getElementById("ma_voucher").value = ma_voucher;
      document.getElementById("giam_gia").value = giam_gia;
      document.getElementById("thoi_gian_het_han").value = thoi_gian_het_han;
      document.getElementById("voucher_id").value = id;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    async function deleteVoucher(id) {
      if (confirm("B·∫°n ch·∫Øc ch·∫Øn mu·ªën x√≥a voucher n√†y?")) {
        await fetch(`${apiURL}/${id}`, {
          method: "DELETE"
        });
        fetchVouchers();
      }
    }

    fetchVouchers();
  </script>
</body>
</html>
